<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TeckwahTMS</title>

    <!-- 파비콘 -->
    <link rel="icon" href="assets/favicon.ico" type="image/x-icon" />
    <link rel="shortcut icon" href="assets/favicon.ico" type="image/x-icon" />

    <!-- Ant Design CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/antd@5.11.0/dist/reset.css"
    />

    <!-- 사용자 정의 CSS -->
    <link rel="stylesheet" href="styles/additional.css" />

    <!-- 폰트 어썸 -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
    />

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  </head>
  <body>
    <div id="app" class="app">
      <!-- 레이아웃 -->
      <div class="main-layout">
        <!-- 사이드바 -->
        <aside id="sidebar" class="sidebar">
          <img
            class="logo"
            src="assets/logo.png"
            alt="로고"
            style="
              width: 100%;
              max-width: 200px;
              margin: 15px auto;
              display: block;
            "
          />
          <div class="logo-container" style="align-content: center">
            <h1>TWLKR-TMS</h1>
          </div>

          <div class="user-info">
            <div class="avatar">
              <i class="fa-solid fa-user"></i>
            </div>
            <div class="user-details">
              <p class="user-name">CSAdmin</p>
              <p class="user-role">CS</p>
            </div>
          </div>

          <nav class="menu">
            <ul>
              <li class="menu-item">
                <a href="index.html">
                  <i class="fa-solid fa-chart-line"></i>
                  <span>TMS</span>
                </a>
              </li>
              <li class="menu-item">
                <a href="handover.html">
                  <i class="fa-solid fa-right-left"></i>
                  <span>Work-Notice</span>
                </a>
              </li>
              <li class="menu-item active">
                <a href="visualization.html">
                  <i class="fa-solid fa-chart-bar"></i>
                  <span>Visualization</span>
                </a>
              </li>
            </ul>
          </nav>

          <div class="logout-container">
            <button id="logoutBtn" class="logout-btn">
              <i class="fa-solid fa-right-from-bracket"></i>
              <span>로그아웃</span>
            </button>
          </div>
        </aside>

        <!-- 메인 컨텐츠 -->
        <main class="main-content">
          <!-- 컨텐츠 영역 -->
          <div id="content-container" class="content-container">
            <!-- 시각화 페이지 -->
            <div class="page-section" id="visualizationPage">
              <div class="main-card">
                <div class="card-header">
                  <!-- 시각화 컨트롤 패널 - 모든 컨트롤을 한 라인에 배치 -->
                  <!-- 개선된 컨트롤 패널 - 사용자 중심 흐름 -->
                </div>

                <div
                  class="control-panel"
                  style="
                    background-color: #f9f9f9;
                    padding: 15px;
                    border-radius: 8px;
                    margin-bottom: 20px;
                  "
                >
                  <!-- 단계별 인터페이스 -->
                  <div
                    class="step-container"
                    style="display: flex; flex-direction: column; gap: 15px"
                  >
                    <!-- 1단계: 시각화 유형 선택 -->
                    <div class="step-item">
                      <div
                        class="step-header"
                        style="
                          display: flex;
                          align-items: center;
                          margin-bottom: 8px;
                        "
                      >
                        <span
                          class="step-number"
                          style="
                            background-color: #1890ff;
                            color: white;
                            border-radius: 50%;
                            width: 24px;
                            height: 24px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            margin-right: 8px;
                          "
                          >1</span
                        >
                        <h3 style="margin: 0; font-size: 16px">
                          시각화 유형 선택
                        </h3>
                      </div>
                      <div class="step-content">
                        <select
                          id="vizChartType"
                          class="filter-select"
                          style="width: 100%; max-width: 400px; padding: 8px"
                        >
                          <option value="">
                            -- 시각화 유형을 선택하세요 --
                          </option>
                          <option value="time">시간대별 주문 접수</option>
                          <option value="dept-status">
                            부서별 배송 상태 분포
                          </option>
                        </select>
                      </div>
                    </div>

                    <!-- 2단계: 필터 설정 (유형 선택 후 표시) -->
                    <div
                      id="filterStep"
                      class="step-item"
                      style="display: none"
                    >
                      <div
                        class="step-header"
                        style="
                          display: flex;
                          align-items: center;
                          margin-bottom: 8px;
                        "
                      >
                        <span
                          class="step-number"
                          style="
                            background-color: #1890ff;
                            color: white;
                            border-radius: 50%;
                            width: 24px;
                            height: 24px;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            margin-right: 8px;
                          "
                          >2</span
                        >
                        <h3 style="margin: 0; font-size: 16px">필터 설정</h3>
                      </div>
                      <div
                        class="step-content"
                        style="
                          display: flex;
                          flex-wrap: wrap;
                          gap: 20px;
                          align-items: flex-end;
                        "
                      >
                        <!-- 날짜 필터 -->
                        <div class="filter-group">
                          <label
                            id="dateFilterTitle"
                            style="display: block; margin-bottom: 5px"
                            >기간</label
                          >
                          <div
                            class="daterange-picker"
                            style="display: flex; align-items: center"
                          >
                            <input
                              type="date"
                              id="vizStartDate"
                              class="date-input"
                              style="width: 130px; padding: 6px"
                            />
                            <span class="date-separator" style="margin: 0 5px"
                              >~</span
                            >
                            <input
                              type="date"
                              id="vizEndDate"
                              class="date-input"
                              style="width: 130px; padding: 6px"
                            />
                          </div>
                        </div>

                        <!-- 부서 필터 -->
                        <div class="filter-group" style="display: none">
                          <label
                            for="vizDepartmentFilter"
                            style="display: block; margin-bottom: 5px"
                            >부서</label
                          >
                          <select
                            id="vizDepartmentFilter"
                            class="filter-select"
                            style="width: 150px; padding: 6px"
                          >
                            <option value="">전체</option>
                            <option value="CS">CS</option>
                            <option value="HES">HES</option>
                            <option value="LENOVO">LENOVO</option>
                          </select>
                        </div>

                        <!-- 조회 버튼 -->
                        <div class="filter-group">
                          <button
                            class="btn primary-btn"
                            id="applyVizFilterBtn"
                            style="padding: 6px 15px"
                          >
                            <i class="fa-solid fa-eye"></i> 보기
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- 차트가 표시될 영역 (처음에는 안내 메시지 표시) -->
                <div id="chartPlaceholder" class="chart-placeholder">
                  <i class="fa-solid fa-chart-line"></i>
                  <h3>
                    시각화 유형을 선택하고 필터를 설정한 후 보기 버튼을
                    눌러주세요
                  </h3>
                </div>

                <!-- 차트 영역 - 초기에는 숨김 처리 -->
                <div
                  id="chartContainerWrapper"
                  class="visualization-container"
                  style="display: none"
                >
                  <!-- 시간대별 차트 -->
                  <div class="chart-container" id="mainChartContainer">
                    <div
                      id="timeChartLoading"
                      class="chart-loading"
                      style="display: none"
                    >
                      <i class="fa-solid fa-spinner"></i>
                      <span>차트를 불러오는 중...</span>
                    </div>
                    <canvas id="orderTimeChart"></canvas>
                  </div>

                  <!-- 부서별 차트 컨테이너 -->
                  <div
                    class="department-charts"
                    id="departmentChartsContainer"
                    style="display: none"
                  >
                    <div
                      class="department-chart-row"
                      style="
                        display: flex;
                        justify-content: space-between;
                        gap: 20px;
                        margin-bottom: 20px;
                      "
                    >
                      <div
                        class="department-chart"
                        id="csChart"
                        style="
                          flex: 1;
                          background-color: white;
                          border-radius: 8px;
                          padding: 15px;
                          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                        "
                      >
                        <h4
                          style="
                            text-align: center;
                            margin-bottom: 15px;
                            font-size: 16px;
                            color: #333;
                          "
                        >
                          CS 부서
                        </h4>
                        <div class="chart-loading" style="display: none">
                          <i class="fa-solid fa-spinner fa-spin"></i>
                          <span>차트를 불러오는 중...</span>
                        </div>
                        <div class="chart-container" style="height: 250px">
                          <canvas id="csChartCanvas"></canvas>
                        </div>
                      </div>
                      <div
                        class="department-chart"
                        id="hesChart"
                        style="
                          flex: 1;
                          background-color: white;
                          border-radius: 8px;
                          padding: 15px;
                          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                        "
                      >
                        <h4
                          style="
                            text-align: center;
                            margin-bottom: 15px;
                            font-size: 16px;
                            color: #333;
                          "
                        >
                          HES 부서
                        </h4>
                        <div class="chart-loading" style="display: none">
                          <i class="fa-solid fa-spinner fa-spin"></i>
                          <span>차트를 불러오는 중...</span>
                        </div>
                        <div class="chart-container" style="height: 250px">
                          <canvas id="hesChartCanvas"></canvas>
                        </div>
                      </div>
                      <div
                        class="department-chart"
                        id="lenovoChart"
                        style="
                          flex: 1;
                          background-color: white;
                          border-radius: 8px;
                          padding: 15px;
                          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                        "
                      >
                        <h4
                          style="
                            text-align: center;
                            margin-bottom: 15px;
                            font-size: 16px;
                            color: #333;
                          "
                        >
                          LENOVO 부서
                        </h4>
                        <div class="chart-loading" style="display: none">
                          <i class="fa-solid fa-spinner fa-spin"></i>
                          <span>차트를 불러오는 중...</span>
                        </div>
                        <div class="chart-container" style="height: 250px">
                          <canvas id="lenovoChartCanvas"></canvas>
                        </div>
                      </div>
                    </div>
                    <div
                      class="department-chart"
                      id="allDeptChart"
                      style="display: none"
                    >
                      <h4>전체 부서 비교</h4>
                      <div class="chart-loading" style="display: none">
                        <i class="fa-solid fa-spinner fa-spin"></i>
                        <span>차트를 불러오는 중...</span>
                      </div>
                      <div class="chart-container">
                        <canvas id="allDeptChartCanvas"></canvas>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>

    <!-- 메시지 팝업 컴포넌트 -->
    <div id="messagePopup" class="message-popup">
      <div class="message-content">
        <i class="fa-solid message-icon"></i>
        <span class="message-text"></span>
      </div>
    </div>

    <!-- JavaScript 파일 -->
    <script src="js/utils.js"></script>
    <script src="js/app.js"></script>
    <script src="js/visualization.js"></script>
    <!-- JavaScript 코드는 app.js에서 페이지를 자동으로 초기화합니다 -->
  </body>
</html>
